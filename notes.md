
workflow
- user (researcher) makes a new researcher account
    - add email and password to database
    - participant contact info blurb
- user makes a new study. 
- app provides user with a study signup url to distribute to participants.
- user adds ping templates to the study
- user gives study signup url to participants. includes query variable with study pid.
- study signup page:
    - asks for timezone
    - collects and saves study pid
    - explains how to download telegram
    - generates a unique signup code
    - provides link to telegram with populated message with unique signup code
    - can regenerate signup code if it's expired
- participant goes to telegram and submits a code generated by the app
- participant is now enrolled in study and telegram id is saved 

- participants can also visit study management page where they can
    - view active studies
    - unenroll from studies
    - update timezone
    - find researcher contact info



'''
DB schema

PK                      SK                          GSI1PK           GSI1SK           GSI2PK           GSI2SK           Attributes
USER#UserID             USER#UserID                                                                                     User details
USER#UserID             STUDY#StudyID                                                                                   Relationship data
STUDY#StudyID           STUDY#StudyID                                                                                   Study details
STUDY#StudyID           USER#UserID                                                                                     Relationship data
STUDY#StudyID           PARTICIPANT#PartID                                                                              Relationship data
PARTICIPANT#PartID      PARTICIPANT#PartID                                                                              Participant details
PARTICIPANT#PartID      STUDY#StudyID                                                                                   Relationship data
PARTICIPANT#PartID      PING#PingID           STUDY#StudyID    PING#PingID    PINGTEMPLATE#PingTemplateID    PING#PingID    Ping details
STUDY#StudyID           PINGTEMPLATE#TemplateID                                                                         Template details
PINGTEMPLATE#TemplateID PINGTEMPLATE#TemplateID

'''
- TOKEN#token, USER#UserID
    - email
- EMAIL#Email, USER#UserID
- STUDY#StudyID, STUDY#StudyID
    - GSI1 - CODE#StudyCode
- USER#UserID, STUDY#StudyID 
- STUDY#StudyID, USER#UserID 
- PARTICIPANT#PartID, PARTICIPANT#PartID
    - GSI1 - TELEGRAM#TelegramID
- STUDY#StudyID, PARTICIPANT#PartID
    - GSI1 - PID#StudyPid
- PARTICIPANT#PartID, STUDY#StudyID
    - GSI1 - PID#StudyPid
- PARTICIPANT#PartID, PING#PingID
    - GSI1 - STUDY#StudyID, PING#PingID
    - GSI2 - PINGTEMPLATE#PingTemplateID, PING#PingID
- STUDY#StudyID, PINGTEMPLATE#TemplateID


Table: users
columns: id, email, password, first_name, last_name, institution

Table: studies
columns: id, public_name, internal_name

Table: pings
columns: id, scheduled_ts, expire_ts, reminder_ts, day_num, url, ping_sent, reminder_sent

Table: ping_templates
columns: id, name, message, url, reminder_latency, expire_latency, start_day_num, schedule

Table: participants:
columns: id, telegram_id, tz

relations:
users - studies - many to many
studies - pings - one to many
studies - ping_templates - one to many
ping_templates - pings - one to many
participants - pings - one to many
studies - pings - one to many



GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO ashish;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO ashish;
GRANT USAGE ON SCHEMA public TO ashish;
GRANT USAGE, SELECT ON ALL SEQUENCES IN SCHEMA public TO ashish;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT USAGE, SELECT ON SEQUENCES TO ashish;
